<!DOCTYPE html>
<html>
<head>
  <title>RoadTripper Viewport</title>
  <style>
    html, body, #pano { height: 100%; margin: 0; padding: 0; }
  </style>
</head>
<body>
  <div id="pano"></div>
  <script>
    let panorama;

    function initPanorama(lat, lng, heading, panoId) {
      const options = {
        pov: { heading: heading || 0, pitch: 0 },
        visible: true,
        disableDefaultUI: true
      };
      
      if (panoId) {
        options.pano = panoId;
      } else {
        options.position = { lat, lng };
      }

      panorama = new google.maps.StreetViewPanorama(
        document.getElementById("pano"),
        options
      );
      return !!panorama;
    }

    function getLinks() {
      return panorama.getLinks();
    }

    function moveToPano(panoId, heading) {
      panorama.setPano(panoId);
      if (heading !== undefined) {
        panorama.setPov({ heading: heading, pitch: 0 });
      }
    }

    function getPosition() {
      const pos = panorama.getPosition();
      if (!pos) return null;
      return { 
        lat: pos.lat(), 
        lng: pos.lng(), 
        heading: panorama.getPov().heading,
        pano: panorama.getPano()
      };
    }
  </script>
</body>
</html>
